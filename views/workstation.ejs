<html>
    <head>
        <style>
            .workstation {
                flex: 1; 
                display: flex;
                align-items: center;
                justify-content: center; 
                margin-right: -0.5rem;
            }

            .order-display {
                flex: 1; 
                display: flex;
                align-items: center;
                justify-content: center; 
                margin-right: -0.5rem;
            }
        </style>
        <%- include('partials/navbar_warehouse') %>
        <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" integrity="...">
        
        <!-- Bootstrap JavaScript (popper.js and Bootstrap JS) -->
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="..."></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js" integrity="..."></script>

        <style>
          .btn {
            color: #000000;
            background-color: #e8c7c8;
            border-color: #e8c7c8;
          }

          .btn:hover {
            color: #000000;
            background-color: #b86d7e;
            border-color: #b86d7e;
        }
        </style>
        <title>Warehouse Workstation</title>
    </head>

    <body>
        <div class="workstation">
            <h3>Workstation</h3>
            <br><br>
        </div>

        <div class="order-display">
            <table border="1", padding="15px">
                <tr>
                    <th style="text-align: center; padding: 20px">Order Date</th>
                    <th style="padding: 20px">Order ID</th>
                    <th style="padding: 20px">Order Status</th>
                    <th style="text-align: center; padding: 20px">Print</th>
                    <th style="padding: 20px">Update Status</th>
                </tr>
                <% for (part in all) { %>
                <tr>
                    <td style="text-align: center; padding: 20px"><%= all[part].date %></td>
                    <td style="text-align: center;"><%= all[part].id %></td>
                    <td style="text-align: center;" id="orderStatus_<%= all[part].id %>""><%= all[part].status %></td>
                    <td style="text-align: center; padding: 20px"><button type="button" id="printPackingListBtn" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#printPackingListModal">Print Packing List</button>
                        <div class="modal fade" id="printPackingListModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered">
                              <div class="modal-content">
                                <div class="modal-header">
                                  <h1 class="modal-title fs-5" id="exampleModalLabel">Print Confirmation</h1>
                                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                Packing List Printed!
                                </div>
                                <div class="modal-footer">
                                  <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Close</button>
                                </div>
                              </div>
                            </div>
                          </div>
                        
                    <br><br><button type="button" id="printLabelsBtn" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#printLabelsModal">Print Invoice and Shipping Label</button></td>
                    <div class="modal fade" id="printLabelsModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered">
                          <div class="modal-content">
                            <div class="modal-header">
                              <h1 class="modal-title fs-5" id="exampleModalLabel">Print Confirmation</h1>
                              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                            Invoice and Shipping Label Printed!
                            </div>
                            <div class="modal-footer">
                              <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Close</button>
                            </div>
                          </div>
                        </div>
                      </div>
                    <td style="text-align: center;">
                        <input type="button" class="btn btn-primary" id="shipped" name="shipped" value="Mark Shipped" onclick="markShipped('<%= all[part].id %>', '<%= all[part].status %>')"></td>
                </tr>
                <% }; %>
            </table>
        </div>

        <script>
            function markShipped(orderId, currentStatus) {
                fetch(`/updateOrderStatus/${orderId}/${currentStatus}`, {
                    method: 'POST',
                })
                .then(response => response.json())
                .then(data => {
                    console.log(data);
                    // Update the order status on the page without a full refresh
                    const orderStatusElement = document.getElementById(`orderStatus_${orderId}`);
                    if (orderStatusElement) {
                        orderStatusElement.innerText = 'shipped'; // Update to the new status
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                });
                location.reload();
            }
        </script>
    </body>
</html>